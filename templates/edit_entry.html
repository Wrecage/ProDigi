<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ProDigi - Edit Entry</title>
  <script>
          document.addEventListener("DOMContentLoaded", function() {
        var checkTextButton = document.getElementById("checkTextButton");
        checkTextButton.addEventListener("click", handleCheckText);
      });

      function handleCheckText(event) {
        event.preventDefault(); 
        var formData = new FormData(document.getElementById("entryForm"));
        var text = formData.get("content"); 
        fetchTextSuggestions(text);
      }

      function fetchTextSuggestions(text) {
        fetch("https://api.languagetool.org/v2/check", {
            method: "POST",
            body: "text=" + encodeURIComponent(text) + "&language=en-US",
            headers: {
                "Content-Type": "application/x-www-form-urlencoded"
            }
        })
        .then(response => response.json())
        .then(displaySuggestions)
        .catch(handleError);
      }

      function displaySuggestions(data) {
        var suggestionsList = document.getElementById("suggestionsList");
        suggestionsList.innerHTML = "";
        data.matches.forEach(match => {
            var listItem = document.createElement("div");
            if (match.context) {
                var correctedText = match.context.text.slice(0, match.context.offset) +
                                    `<span class="error-location ">${match.context.text.slice(match.context.offset, match.context.offset + match.context.length)}</span>` +
                                    match.context.text.slice(match.context.offset + match.context.length);
                listItem.innerHTML = `
                    <p class="error">✗ ${correctedText}</p>
                    <p class="correction">✓ ${match.message}</p>
                `;
            } else {
                listItem.textContent = match.message;
            }
            suggestionsList.appendChild(listItem);
        });
      }

      function handleError(error) {
        console.error("Error:", error);
      }

</script>
 </head>
    <style>

      body {
        font-family: sans-serif;
        background-color: #333333; 
      }
      h1 {
        text-align: center;
        color: #ffff;
        margin-bottom: 1em;
      }

      .container {
        display: flex;
        flex: 1; 
        max-width: 1000px;
        margin: 0 auto;
        padding: 1em;
        background-color: #333333; 
        border-radius: 5px;
      }


      .input-container {
        flex: 1; 
        padding: 1em;
        background-color: #3f3d3d; 
        border-radius: 5px;
      }


      form.edit-form {
          margin: 1em;
          padding: 1em;
          background-color: #333; 
          border-radius: 10px;
          box-shadow: 0 0 20px rgba(44, 62, 80, 0.2); 
          color: #ffffff; 
      }



      form.edit-form p {
          margin-bottom: 15px;
          color: #f5f4f4;
          border-bottom: 2px solid #FF5733;
          padding-bottom: 5px;
          margin-bottom: 15px; 
          font-family: 'Courier New', monospace;
      }


      form.edit-form input[type="date"],
      form.edit-form input[type="time"],
      form.edit-form input[type="text"]
      {
          padding: 8px;
          width: 100%;
          margin-bottom: 15px;
          border: 1px solid #FF5733;
          border-radius: 5px;
          box-sizing: border-box;
          color: #2c3e50; 
          background-color: #FAFAD2;
      }


      form.edit-form textarea {
          padding: 20px;
          width: 100%;
          margin-bottom: 15px;
          border: 1px solid #FF5733;
          border-radius: 5px;
          box-sizing: border-box;
          color: #2c3e50; 
          background-color: #FAFAD2;
          position: relative;
      }


      form.edit-form input[type="text"]::placeholder,
      form.edit-form textarea::placeholder {
          color: #95a5a6; 
      }

      form.edit-form input[type="text"]:focus,
      form.edit-form textarea:focus {
          outline: none;
          border-color: #2ecc71; 
          box-shadow: 0 0 5px rgba(46, 204, 113, 0.5); 
      }

      form.edit-form button, button {
          padding: 10px;
          background-color: #333333;
          color: #FF5733;
          border: none;
          border-radius: 5px;
          cursor: pointer;
          transition: background-color 0.3s ease;
      }

      form.edit-form button:hover, button:hover {
            background-color: #FF5733;
            color: #333333;
            transition: 0.7s;
        }

     
      .navigation {
            position:absolute;
            top: 0;
            right: 0;
            padding: 15px;
            box-sizing: border-box;
            z-index: 1000;
            background-color: #333333;
        }

        .navigation img {
            width: 40px; 
            height: 40px; 
            border-radius: 50%; 
            margin-right: 10px; 
        }

        .navigation a {
            color: #535252;
            text-decoration: none;
            font-weight: bold;
        }

        .suggestions-container {
            margin-top: 33px;
            width: 300px;
            max-width: 500px;
            background: #e7e5e5;
            padding: 20px;
            border-radius: 5px;
            color:#020202;
            overflow-y: auto; 
            max-height: fit-content;
            margin-bottom: 32.5px;
        }

        .suggestion {
            margin-bottom: 5px;
        }

        .error {
            color: red;
            margin-bottom: 10px;
        }

        .correction {
            color: rgb(2, 2, 2);
        }
        
        .error-location {
            background-color: rgba(252, 252, 70, 0.712);
            padding: 2px;
            border-radius: 2px;
        }

    </style>

   
<body>


  <div class="navigation">
    <a href="/profile">
        <img src="https://images.rawpixel.com/image_png_800/cHJpdmF0ZS9sci9pbWFnZXMvd2Vic2l0ZS8yMDIzLTAxL3JtNjA5LXNvbGlkaWNvbi13LTAwMi1wLnBuZw.png" alt="Profile Image">
    </a>
</div>

  <div class="container">
    <form method="post" class="edit-form" id="entryForm">
      {% csrf_token %}
      <div class="input-container">
        {{ form.as_p }}
        <button type="submit">Save Changes</button>
        <button id="checkTextButton">Check Text</button>
      </div>
    </form>


    <div class="suggestions-container">
      <h2>Suggestions</h2>
      <h6>(Powered by Language Tool)</h6>
      <div id="suggestionsList"></div>
      <button type="button">Apply Suggestions</button>
      <button type="button">Ignore Suggestions</button>
    </div>


  </div>
  
</body>


</html>
